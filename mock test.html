<!DOCTYPE html>
<html>
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <title>Mock Exam Facility</title>
    <style>
        #timer { font-size: 1.5rem; font-weight: bold; color: #e74c3c; }
        .question-card { border-left: 5px solid #3498db; margin-bottom: 20px; }
    </style>
</head>
<body class="bg-light">
    <div class="container mt-5">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>General Aptitude Mock Test</h2>
            <div id="timer">Time Left: <span id="time">01:00</span></div>
        </div>

        <form id="quizForm">
            {% for q in questions %}
            <div class="card question-card p-4 shadow-sm">
                <p class="h5">{{ loop.index }}. {{ q.q }}</p>
                {% for option in q.options %}
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="q{{ q.id }}" value="{{ option }}" required>
                    <label class="form-check-label">{{ option }}</label>
                </div>
                {% endfor %}
            </div>
            {% endfor %}

            <button type="submit" class="btn btn-success btn-lg w-100 mt-4">Submit Exam</button>
        </form>

        <div id="results" class="mt-5 d-none">
            <div class="alert alert-success p-5 text-center">
                <h1 id="scoreDisplay"></h1>
                <p>Great effort! Your results have been saved to your career profile.</p>
                <a href="/" class="btn btn-outline-primary">Back to Dashboard</a>
            </div>
        </div>
    </div>

    <script>
        // 1. Timer Logic
        let seconds = 60;
        const timerDisplay = document.getElementById('time');
        
        const countdown = setInterval(() => {
            seconds--;
            let mins = Math.floor(seconds / 60);
            let secs = seconds % 60;
            timerDisplay.innerHTML = `${mins}:${secs < 10 ? '0' : ''}${secs}`;
            
            if (seconds <= 0) {
                clearInterval(countdown);
                alert("Time is up! Submitting your answers.");
                document.getElementById('quizForm').requestSubmit();
            }
        }, 1000);

        // 2. Scoring Logic
        document.getElementById('quizForm').onsubmit = function(e) {
            e.preventDefault();
            clearInterval(countdown); // Stop the timer

            let score = 0;
            const answers = {
                "q1": "30",
                "q2": "Python"
            };

            let formData = new FormData(this);
            for (let [key, value] of formData.entries()) {
                if (answers[key] === value) {
                    score++;
                }
            }

            // Show results
            document.getElementById('quizForm').classList.add('d-none');
            document.getElementById('timer').classList.add('d-none');
            const resultDiv = document.getElementById('results');
            resultDiv.classList.remove('d-none');
            document.getElementById('scoreDisplay').innerText = `Your Score: ${score} / 2`;
        };
    </script>
</body>
</html>